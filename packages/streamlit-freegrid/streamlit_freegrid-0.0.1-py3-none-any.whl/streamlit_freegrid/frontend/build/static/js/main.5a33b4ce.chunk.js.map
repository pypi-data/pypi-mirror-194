{"version":3,"sources":["StreamlitFreeGrid.tsx","index.tsx"],"names":["getDataGridInfos","df","labels","hide","types","data","columns","rows","columnVisibility","n","p","regex","RegExp","push","field","headerName","flex","editable","_loop","columnCell","getCell","j","content","toString","columnData","Object","keys","includes","typeData","type","params","React","createElement","alt","undefined","id","src","value","height","Date","toLocaleString","lang","options","test","i","row","console","log","StreamlitFreeGrid","_StreamlitComponentBa","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","state","props","pageSize","render","Box","sx","width","DataGrid","initialState","columnVisibilityModel","disableSelectionOnClick","_createClass","StreamlitComponentBase","withStreamlitConnection","ReactDOM","StrictMode","MyComponent","document","getElementById"],"mappings":"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","file":"static/js/main.5a33b4ce.chunk.js","sourcesContent":["import {\n  ArrowTable,\n  Streamlit,\n  StreamlitComponentBase,\n  withStreamlitConnection,\n} from \"streamlit-component-lib\"\nimport React, { ReactNode } from \"react\"\nimport {Box} from \"@mui/material\";\nimport {DataGrid, GridColDef, GridColumnVisibilityModel, GridRowId, GridValueGetterParams} from '@mui/x-data-grid';\n\ninterface State {\n}\n\ninterface Data {\n  columns: GridColDef[],\n  rows: object[],\n  columnVisibility: GridColumnVisibilityModel\n}\n\ninterface TypeData {\n  type: string\n  options?: object\n  lang?: string\n}\n\nconst html_image = (src: string, height: number, width: number, name: string, i: GridRowId | undefined) => {\n  const alt: string = `image_${name}_${(i !== undefined)? i.toString():\"null\"}`\n  return (\n    <img alt={alt} src={src} height={height} width={width}/>\n  )\n}\n\nconst getDataGridInfos = (df: ArrowTable, labels: object, hide: string[], types: object) => {\n  const data: Data = {columns: [], rows: [], columnVisibility: {}}\n  const n = df.rows\n  const p = df.columns\n  const regex: RegExp = new RegExp(\"[0-9]+\")\n  data.columns.push({field: \"id\", headerName: \"id\", flex: 1, editable: false,})\n  data.columnVisibility[\"id\"] = false\n  // generate columns data\n  for (let j = 1; j < p ; j++) {\n    const columnCell = df.getCell(0, j)\n    let field: string = (columnCell.content !== null && columnCell.content !== \"\")? columnCell.content.toString(): j.toString()\n    let headerName: string\n    if (field === \"id\") {\n      field = \"_id\"\n      headerName = \"_id\"\n    }\n    // headerName from labels props\n    if (Object.keys(labels).includes(field)) {\n      headerName = labels[field as keyof object]\n    } else {\n      headerName = field\n    }\n    // generate column\n    const columnData: GridColDef = {field: field, headerName: headerName, flex: 1, editable: false,}\n    if (Object.keys(types).includes(field)) {\n      const typeData: TypeData = types[field as keyof object]\n      switch (typeData.type) {\n        case \"image\":\n          columnData[\"renderCell\"] = params => (<img alt={(params.id !== undefined)? headerName+params.id.toString(): headerName+\"null\"} src={params.value} height=\"100%\"/>)\n          break\n        case \"date\":\n          columnData[\"valueFormatter\"] = params => new Date(params?.value * 1000000).toLocaleString(typeData.lang, typeData.options)\n          break\n      }\n    }\n    data.columns.push(columnData)\n    // hide columns from hide props\n    data.columnVisibility[field] = !(regex.test(field) || hide.includes(field))\n  }\n  // generate rows data\n  for (let i = 1; i < n; i++) {\n    const row: any = {}\n    row[\"id\"] = i\n    for (let j = 1; j < p; j++) {\n      row[data.columns[j].field] = df.getCell(i, j).content\n    }\n    data.rows.push(row)\n  }\n  console.log(data)\n  return data\n}\n\nclass StreamlitFreeGrid extends StreamlitComponentBase<State> {\n  public state: State = {}\n  private df: ArrowTable = this.props.args[\"df\"]\n  private height: number = this.props.args[\"height\"]\n  private pageSize: number = this.props.args[\"pageSize\"]\n  private labels: object = this.props.args[\"labels\"]\n  private hide: string[] = this.props.args[\"hide\"]\n  private types: object = this.props.args[\"types\"]\n\n  public render = (): ReactNode => {\n    const data = getDataGridInfos(this.df, this.labels, this.hide, this.types)\n    return (\n      <Box\n        sx={{\n          height: this.height,\n          width: \"100%\",\n        }}\n      >\n        <DataGrid\n          initialState={{\n            columns: {columnVisibilityModel: data.columnVisibility}\n          }}\n          columns={data.columns}\n          rows={data.rows}\n          pageSize={this.pageSize}\n          disableSelectionOnClick/>\n      </Box>\n    )\n  }\n}\n\nexport default withStreamlitConnection(StreamlitFreeGrid)\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport MyComponent from \"./StreamlitFreeGrid\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <MyComponent />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}