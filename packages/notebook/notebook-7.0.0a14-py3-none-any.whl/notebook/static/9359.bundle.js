"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[9359],{79359:(e,t,i)=>{i.r(t),i.d(t,{EditorTableOfContentsFactory:()=>T,FileEditor:()=>u,FileEditorAdapter:()=>s,FileEditorFactory:()=>p,FileEditorSearchProvider:()=>g,IEditorTracker:()=>k,LaTeXTableOfContentsFactory:()=>P,LaTeXTableOfContentsModel:()=>E,MarkdownTableOfContentsFactory:()=>A,MarkdownTableOfContentsModel:()=>S,PythonTableOfContentsFactory:()=>F,PythonTableOfContentsModel:()=>O,TabSpaceStatus:()=>x});var n=i(75858),o=i(41759);class s extends n.WidgetLSPAdapter{constructor(e,t){const{docRegistry:i,...n}=t;super(e,n),this._readyDelegate=new o.PromiseDelegate,this.editor=e.content,this._docRegistry=i,this._virtualEditor=Object.freeze({getEditor:()=>this.editor.editor,ready:()=>Promise.resolve(this.editor.editor),reveal:()=>Promise.resolve(this.editor.editor)}),Promise.all([this.editor.context.ready,this.connectionManager.ready]).then((async()=>{await this.initOnceReady(),this._readyDelegate.resolve()})).catch(console.error)}get ready(){return this._readyDelegate.promise}get documentPath(){return this.widget.context.path}get mimeType(){var e;const t=this.editor.model.mimeType,i=Array.isArray(t)?null!==(e=t[0])&&void 0!==e?e:"text/plain":t,n=this.editor.context.contentsModel;return"text/plain"!=i?i:n?this._docRegistry.getFileTypeForModel(n).mimeTypes[0]:i}get languageFileExtension(){let e=this.documentPath.split(".");return e[e.length-1]}get ceEditor(){return this.editor.editor}get activeEditor(){return this._virtualEditor}get wrapperElement(){return this.widget.node}get path(){return this.widget.context.path}get editors(){var e,t;return[{ceEditor:this._virtualEditor,type:"code",value:null!==(t=null===(e=this.editor)||void 0===e?void 0:e.model.sharedModel.getSource())&&void 0!==t?t:""}]}dispose(){this.isDisposed||(this.editor.model.mimeTypeChanged.disconnect(this.reloadConnection),super.dispose())}createVirtualDocument(){return new n.VirtualDocument({language:this.language,foreignCodeExtractors:this.options.foreignCodeExtractorsManager,path:this.documentPath,fileExtension:this.languageFileExtension,standalone:!0,hasLspSupportedFile:!0})}getEditorIndexAt(e){return 0}getEditorIndex(e){return 0}getEditorWrapper(e){return this.wrapperElement}async initOnceReady(){this.initVirtual(),await this.connectDocument(this.virtualDocument,!1),this.editor.model.mimeTypeChanged.connect(this.reloadConnection,this)}}var r=i(44525),a=i(38932),d=i(11040),c=i(23095),l=i(54629),h=i(83124);class u extends h.Widget{constructor(e){super(),this._ready=new o.PromiseDelegate,this.addClass("jp-FileEditor");const t=this._context=e.context;this._mimeTypeService=e.mimeTypeService;const i=this._editorWidget=new d.CodeEditorWrapper({factory:e.factory,model:t.model});this._editorWidget.addClass("jp-FileEditorCodeWrapper"),this._editorWidget.node.dataset.jpCodeRunner="true",this._editorWidget.node.dataset.jpUndoer="true",this.editor=i.editor,this.model=i.model,t.ready.then((()=>{this._onContextReady()})),t.pathChanged.connect(this._onPathChanged,this),this._onPathChanged(),(this.layout=new h.StackedLayout).addWidget(i)}get context(){return this._context}get ready(){return this._ready.promise}handleEvent(e){this.model&&"mousedown"===e.type&&this._ensureFocus()}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("mousedown",this)}onBeforeDetach(e){this.node.removeEventListener("mousedown",this)}onActivateRequest(e){this._ensureFocus()}_ensureFocus(){this.editor.hasFocus()||this.editor.focus()}_onContextReady(){this.isDisposed||(this.editor.clearHistory(),this._ready.resolve(void 0))}_onPathChanged(){const e=this.editor,t=this._context.localPath;e.model.mimeType=this._mimeTypeService.getMimeTypeByFilePath(t)}}class p extends c.ABCWidgetFactory{constructor(e){super(e.factoryOptions),this._services=e.editorServices}createNewWidget(e){const t=this._services.factoryService.newDocumentEditor,i=new u({factory:e=>t(e),context:e,mimeTypeService:this._services.mimeTypeService});return i.title.icon=l.textEditorIcon,new c.DocumentWidget({content:i,context:e})}}class g extends a.CodeMirrorSearchProvider{constructor(e){super(e.content.editor)}static createNew(e,t){return new g(e)}static isApplicable(e){return e instanceof r.MainAreaWidget&&e.content instanceof u&&e.content.editor instanceof a.CodeMirrorEditor}getInitialQuery(){const e=this.editor,t=e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to);return-1===t.search(/\r?\n|\r/g)?t:""}}var m=i(24787),f=i(99828),y=i(78156),v=i.n(y);function _(e){const t=(e.translator||f.nullTranslator).load("jupyterlab"),i=e.isSpaces?t.__("Spaces"):t.__("Tab Size");return v().createElement(m.TextItem,{onClick:e.handleClick,source:`${i}: ${e.tabSpace}`,title:t.__("Change Tab indentationâ€¦")})}class x extends l.VDomRenderer{constructor(e){super(new x.Model),this._popup=null,this._menu=e.menu,this.translator=e.translator||f.nullTranslator,this.addClass("jp-mod-highlighted")}render(){return this.model&&this.model.config?v().createElement(_,{isSpaces:this.model.config.insertSpaces,tabSpace:this.model.config.tabSize,handleClick:()=>this._handleClick(),translator:this.translator}):null}_handleClick(){const e=this._menu;this._popup&&this._popup.dispose(),e.aboutToClose.connect(this._menuClosed,this),this._popup=(0,m.showPopup)({body:e,anchor:this,align:"right"})}_menuClosed(){this.removeClass("jp-mod-clicked")}}!function(e){class t extends l.VDomModel{constructor(){super(...arguments),this._config=null}get config(){return this._config}set config(e){const t=this._config;this._config=e,this._triggerChange(t,this._config)}_triggerChange(e,t){const i=e&&e.insertSpaces,n=e&&e.tabSize,o=t&&t.insertSpaces,s=t&&t.tabSize;i===o&&n===s||this.stateChanged.emit(void 0)}}e.Model=t}(x||(x={}));var C=i(28759);class T extends C.TableOfContentsFactory{createNew(e,t){const i=super.createNew(e,t),n=(t,i)=>{i&&e.content.editor.setCursorPosition({line:i.line,column:0})};return i.activeHeadingChanged.connect(n),e.disposed.connect((()=>{i.activeHeadingChanged.disconnect(n)})),i}}const b={part:1,chapter:1,section:1,subsection:2,subsubsection:3,paragraph:4,subparagraph:5},w=/^\s*\\(section|subsection|subsubsection){(.+)}/;class E extends C.TableOfContentsModel{get documentType(){return"latex"}get supportedOptions(){return["maximalDepth","numberHeaders"]}getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.sharedModel.getSource().split("\n"),t=new Array;let i=t.length;const n=new Array;for(let o=0;o<e.length;o++){const s=e[o].match(w);if(s){const e=b[s[1]];if(e<=this.configuration.maximalDepth){const r=C.TableOfContentsUtils.getPrefix(e,i,t,{...this.configuration,baseNumbering:1,numberingH1:!0});i=e,n.push({text:s[2],prefix:r,level:e,line:o})}}}return Promise.resolve(n)}}class P extends T{isApplicable(e){var t,i;if(super.isApplicable(e)){let n=null===(i=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===i?void 0:i.mimeType;return n&&("text/x-latex"===n||"text/x-stex"===n)}return!1}_createNew(e,t){return new E(e,t)}}class S extends C.TableOfContentsModel{get documentType(){return"markdown"}getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.sharedModel.getSource(),t=C.TableOfContentsUtils.filterHeadings(C.TableOfContentsUtils.Markdown.getHeadings(e),{...this.configuration,numberHeaders:!1});return Promise.resolve(t)}}class A extends T{isApplicable(e){var t,i;if(super.isApplicable(e)){let n=null===(i=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===i?void 0:i.mimeType;return n&&C.TableOfContentsUtils.Markdown.isMarkdown(n)}return!1}_createNew(e,t){return new S(e,t)}}let M;try{M=new RegExp("^\\s*(class |def |from |import )","d")}catch(e){M=new RegExp("^\\s*(class |def |from |import )")}class O extends C.TableOfContentsModel{get documentType(){return"python"}async getHeadings(){if(!this.isActive)return Promise.resolve(null);const e=this.widget.content.model.sharedModel.getSource().split("\n");let t=new Array,n=!1,o=1,s=-1;for(const r of e){let e;if(s++,M.flags.includes("d"))e=M.exec(r);else{const{default:t}=await i.e(2913).then(i.t.bind(i,32913,23));e=t(M,r)}if(e){const[i]=e.indices[1];1===o&&i>0&&(o=i);const a=["from ","import "].includes(e[1]);if(a&&n)continue;n=a;const d=1+i/o;if(d>this.configuration.maximalDepth)continue;t.push({text:r.slice(i),level:d,line:s})}}return Promise.resolve(t)}}class F extends T{isApplicable(e){var t,i;if(super.isApplicable(e)){let n=null===(i=null===(t=e.content)||void 0===t?void 0:t.model)||void 0===i?void 0:i.mimeType;return n&&("application/x-python-code"===n||"text/x-python"===n)}return!1}_createNew(e,t){return new O(e,t)}}const k=new o.Token("@jupyterlab/fileeditor:IEditorTracker")}}]);