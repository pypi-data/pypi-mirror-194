"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[6256],{86256:(e,n,t)=>{t.r(n),t.d(n,{default:()=>E});var o=t(97390),r=t(44525),a=t(11040),s=t(11834),l=t(5736),i=t(31099),c=t(17904),d=t(69198),u=t(90459),p=t(32344),m=t(99828),C=t(54629),g=t(47728),v=t(41759),b=t(93046),k=t(83848);const h={id:"@jupyterlab/console-extension:foreign",requires:[l.IConsoleTracker,p.ISettingRegistry,m.ITranslator],optional:[r.ICommandPalette],activate:function(e,n,t,o,r){const a=o.load("jupyterlab"),{shell:s}=e;n.widgetAdded.connect(((e,n)=>{const o=n.console,r=new l.ForeignHandler({sessionContext:o.sessionContext,parent:o});y.foreignHandlerProperty.set(o,r),t.get("@jupyterlab/console-extension:tracker","showAllKernelActivity").then((({composite:e})=>{const n=e;r.enabled=n})),o.disposed.connect((()=>{r.dispose()}))}));const{commands:i}=e,c=a.__("Console"),d="console:toggle-show-all-kernel-activity";i.addCommand(d,{label:e=>a.__("Show All Kernel Activity"),execute:e=>{const t=function(e){const t=n.currentWidget;return!1!==e.activate&&t&&s.activateById(t.id),t}(e);if(!t)return;const o=y.foreignHandlerProperty.get(t.console);o&&(o.enabled=!o.enabled)},isToggled:()=>{var e;return null!==n.currentWidget&&!!(null===(e=y.foreignHandlerProperty.get(n.currentWidget.console))||void 0===e?void 0:e.enabled)},isEnabled:()=>null!==n.currentWidget&&n.currentWidget===s.currentWidget}),r&&r.addItem({command:d,category:c,args:{isPalette:!0}})},autoStart:!0},f=h;var y,w;!function(e){e.foreignHandlerProperty=new k.AttachedProperty({name:"foreignHandler",create:()=>{}})}(y||(y={})),function(e){e.autoClosingBrackets="console:toggle-autoclosing-brackets",e.create="console:create",e.clear="console:clear",e.runUnforced="console:run-unforced",e.runForced="console:run-forced",e.linebreak="console:linebreak",e.interrupt="console:interrupt-kernel",e.restart="console:restart-kernel",e.closeAndShutdown="console:close-and-shutdown",e.open="console:open",e.inject="console:inject",e.changeKernel="console:change-kernel",e.getKernel="console:get-kernel",e.enterToExecute="console:enter-to-execute",e.shiftEnterToExecute="console:shift-enter-to-execute",e.interactionMode="console:interaction-mode",e.replaceSelection="console:replace-selection",e.shutdown="console:shutdown",e.invokeCompleter="completer:invoke-console",e.selectCompleter="completer:select-console"}(w||(w={}));const x={id:"@jupyterlab/console-extension:tracker",provides:l.IConsoleTracker,requires:[l.ConsolePanel.IContentFactory,a.IEditorServices,u.IRenderMimeRegistry,p.ISettingRegistry,m.ITranslator],optional:[o.ILayoutRestorer,i.IDefaultFileBrowser,d.IMainMenu,r.ICommandPalette,c.ILauncher,o.ILabStatus,r.ISessionContextDialogs],activate:async function(e,n,t,o,a,s,i,c,d,u,p,m,k){const h=s.load("jupyterlab"),f=e.serviceManager,{commands:y,shell:x}=e,_=h.__("Console");k=null!=k?k:r.sessionContextDialogs;const S=new r.WidgetTracker({namespace:"console"});async function I(e){var r,i;await f.ready;const c=new l.ConsolePanel({manager:f,contentFactory:n,mimeTypeService:t.mimeTypeService,rendermime:o,translator:s,setBusy:null!==(r=m&&(()=>m.setBusy()))&&void 0!==r?r:void 0,...e}),d=(await a.get("@jupyterlab/console-extension:tracker","interactionMode")).composite;return c.console.node.dataset.jpInteractionMode=d,await S.add(c),c.sessionContext.propertyChanged.connect((()=>{S.save(c)})),x.add(c,"main",{ref:e.ref,mode:e.insertMode,activate:!1!==e.activate,type:null!==(i=e.type)&&void 0!==i?i:"Console"}),c}i&&i.restore(S,{command:w.create,args:e=>{const{path:n,name:t,kernelPreference:o}=e.console.sessionContext;return{path:n,name:t,kernelPreference:{...o}}},name:e=>{var n;return null!==(n=e.console.sessionContext.path)&&void 0!==n?n:v.UUID.uuid4()},when:f.ready}),p&&f.ready.then((()=>{let e=null;const n=()=>{e&&(e.dispose(),e=null);const n=f.kernelspecs.specs;if(n){e=new b.DisposableSet;for(const t in n.kernelspecs){const o=t===n.default?0:1/0,r=n.kernelspecs[t],a=r.resources["logo-svg"]||r.resources["logo-64x64"];e.add(p.add({command:w.create,args:{isLauncher:!0,kernelPreference:{name:t}},category:h.__("Console"),rank:o,kernelIconUrl:a,metadata:{kernel:v.JSONExt.deepCopy(r.metadata||{})}}))}}};n(),f.kernelspecs.specsChanged.connect(n)}));const E=(e,n,t)=>{if(void 0!==n[t])switch(t){case"autoClosingBrackets":e.setOption("autoClosingBrackets",n.autoClosingBrackets);break;case"cursorBlinkRate":e.setOption("cursorBlinkRate",n.cursorBlinkRate);break;case"fontFamily":e.setOption("fontFamily",n.fontFamily);break;case"fontSize":e.setOption("fontSize",n.fontSize);break;case"lineHeight":e.setOption("lineHeight",n.lineHeight);break;case"lineNumbers":e.setOption("lineNumbers",n.lineNumbers);break;case"lineWrap":e.setOption("lineWrap",n.lineWrap);break;case"matchBrackets":e.setOption("matchBrackets",n.matchBrackets);break;case"readOnly":e.setOption("readOnly",n.readOnly);break;case"insertSpaces":e.setOption("insertSpaces",n.insertSpaces);break;case"tabSize":e.setOption("tabSize",n.tabSize);break;case"wordWrapColumn":e.setOption("wordWrapColumn",n.wordWrapColumn);break;case"rulers":e.setOption("rulers",n.rulers);break;case"codeFolding":e.setOption("codeFolding",n.codeFolding)}},P=(e,n)=>{void 0!==e&&(E(e,n,"autoClosingBrackets"),E(e,n,"cursorBlinkRate"),E(e,n,"fontFamily"),E(e,n,"fontSize"),E(e,n,"lineHeight"),E(e,n,"lineNumbers"),E(e,n,"lineWrap"),E(e,n,"matchBrackets"),E(e,n,"readOnly"),E(e,n,"insertSpaces"),E(e,n,"tabSize"),E(e,n,"wordWrapColumn"),E(e,n,"rulers"),E(e,n,"codeFolding"))},B="@jupyterlab/console-extension:tracker";let M,O;async function W(e){M=(await a.get(B,"interactionMode")).composite,O=(await a.get(B,"promptCellConfig")).composite;const n=e=>{var n,t;e.console.node.dataset.jpInteractionMode=M,e.console.editorConfig=O,P(null!==(t=null===(n=e.console.promptCell)||void 0===n?void 0:n.editor)&&void 0!==t?t:void 0,O)};e?n(e):S.forEach(n)}function T(){return null!==S.currentWidget&&S.currentWidget===x.currentWidget}a.pluginChanged.connect(((e,n)=>{n===B&&W()})),await W(),S.widgetAdded.connect(((e,n)=>{W(n)})),y.addCommand(w.autoClosingBrackets,{execute:async e=>{var n;O.autoClosingBrackets=!!(null!==(n=e.force)&&void 0!==n?n:!O.autoClosingBrackets),await a.set(B,"promptCellConfig",O)},label:h.__("Auto Close Brackets for Code Console Prompt"),isToggled:()=>O.autoClosingBrackets});let j=w.open;function K(e){const n=S.currentWidget;return!1!==e.activate&&n&&x.activateById(n.id),null!=n?n:null}y.addCommand(j,{label:h.__("Open a console for the provided `path`."),execute:e=>{const n=e.path,t=S.find((e=>{var t;return(null===(t=e.console.sessionContext.session)||void 0===t?void 0:t.path)===n}));return t?(!1!==e.activate&&x.activateById(t.id),t):f.ready.then((()=>(0,g.find)(f.sessions.running(),(e=>e.path===n))?I(e):Promise.reject(`No running kernel session for path: ${n}`)))}}),j=w.create,y.addCommand(j,{label:e=>{var n,t,o,r;if(e.isPalette)return h.__("New Console");if(e.isLauncher&&e.kernelPreference){const a=e.kernelPreference;return null!==(r=null===(o=null===(t=null===(n=f.kernelspecs)||void 0===n?void 0:n.specs)||void 0===t?void 0:t.kernelspecs[a.name||""])||void 0===o?void 0:o.display_name)&&void 0!==r?r:""}return h.__("Console")},icon:e=>e.isPalette?void 0:C.consoleIcon,execute:e=>{var n;return I({basePath:null!==(n=e.basePath||e.cwd||(null==c?void 0:c.model.path))&&void 0!==n?n:"",...e})}}),y.addCommand(w.clear,{label:h.__("Clear Console Cells"),execute:e=>{const n=K(e);n&&n.console.clear()},isEnabled:T}),y.addCommand(w.runUnforced,{label:h.__("Run Cell (unforced)"),execute:e=>{const n=K(e);if(n)return n.console.execute()},isEnabled:T}),y.addCommand(w.runForced,{label:h.__("Run Cell (forced)"),execute:e=>{const n=K(e);if(n)return n.console.execute(!0)},isEnabled:T}),y.addCommand(w.linebreak,{label:h.__("Insert Line Break"),execute:e=>{const n=K(e);n&&n.console.insertLinebreak()},isEnabled:T}),y.addCommand(w.replaceSelection,{label:h.__("Replace Selection in Console"),execute:e=>{const n=K(e);if(!n)return;const t=e.text||"";n.console.replaceSelection(t)},isEnabled:T}),y.addCommand(w.interrupt,{label:h.__("Interrupt Kernel"),execute:e=>{var n;const t=K(e);if(!t)return;const o=null===(n=t.console.sessionContext.session)||void 0===n?void 0:n.kernel;return o?o.interrupt():void 0},isEnabled:T}),y.addCommand(w.restart,{label:h.__("Restart Kernel…"),execute:e=>{const n=K(e);if(n)return k.restart(n.console.sessionContext,s)},isEnabled:T}),y.addCommand(w.shutdown,{label:h.__("Shut Down"),execute:e=>{const n=K(e);if(n)return n.console.sessionContext.shutdown()}}),y.addCommand(w.closeAndShutdown,{label:h.__("Close and Shut Down…"),execute:e=>{const n=K(e);if(n)return(0,r.showDialog)({title:h.__("Shut down the console?"),body:h.__('Are you sure you want to close "%1"?',n.title.label),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton()]}).then((e=>!!e.button.accept&&y.execute(w.shutdown,{activate:!1}).then((()=>(n.dispose(),!0)))))},isEnabled:T}),y.addCommand(w.inject,{label:h.__("Inject some code in a console."),execute:e=>{const n=e.path;S.find((t=>{var o;return(null===(o=t.console.sessionContext.session)||void 0===o?void 0:o.path)===n&&(!1!==e.activate&&x.activateById(t.id),t.console.inject(e.code,e.metadata),!0)}))},isEnabled:T}),y.addCommand(w.changeKernel,{label:h.__("Change Kernel…"),execute:e=>{const n=K(e);if(n)return k.selectKernel(n.console.sessionContext,s)},isEnabled:T}),y.addCommand(w.getKernel,{label:h.__("Get Kernel"),execute:e=>{var n;const t=K({activate:!1,...e});if(t)return null===(n=t.sessionContext.session)||void 0===n?void 0:n.kernel},isEnabled:T}),u&&[w.create,w.linebreak,w.clear,w.runUnforced,w.runForced,w.restart,w.interrupt,w.changeKernel,w.closeAndShutdown].forEach((e=>{u.addItem({command:e,category:_,args:{isPalette:!0}})})),d&&(d.fileMenu.closeAndCleaners.add({id:w.closeAndShutdown,isEnabled:T}),d.kernelMenu.kernelUsers.changeKernel.add({id:w.changeKernel,isEnabled:T}),d.kernelMenu.kernelUsers.clearWidget.add({id:w.clear,isEnabled:T}),d.kernelMenu.kernelUsers.interruptKernel.add({id:w.interrupt,isEnabled:T}),d.kernelMenu.kernelUsers.restartKernel.add({id:w.restart,isEnabled:T}),d.kernelMenu.kernelUsers.shutdownKernel.add({id:w.shutdown,isEnabled:T}),d.runMenu.codeRunners.run.add({id:w.runForced,isEnabled:T}),d.editMenu.clearers.clearCurrent.add({id:w.clear,isEnabled:T}),d.helpMenu.getKernel.add({id:w.getKernel,isEnabled:T}));const F={notebook:h.__("Execute with Shift+Enter"),terminal:h.__("Execute with Enter")};return y.addCommand(w.interactionMode,{label:e=>{var n;return null!==(n=F[e.interactionMode])&&void 0!==n?n:"Set the console interaction mode."},execute:async e=>{try{await a.set(B,"interactionMode",e.interactionMode)}catch(e){console.error(`Failed to set ${B}:keyMap - ${e.message}`)}},isToggled:e=>e.interactionMode===M}),S},autoStart:!0},_={id:"@jupyterlab/console-extension:factory",provides:l.ConsolePanel.IContentFactory,requires:[a.IEditorServices],autoStart:!0,activate:(e,n)=>{const t=n.factoryService.newInlineEditor;return new l.ConsolePanel.ContentFactory({editorFactory:t})}},S={id:"@jupyterlab/console-extension:kernel-status",autoStart:!0,requires:[l.IConsoleTracker,r.IKernelStatusModel],activate:(e,n,t)=>{t.addSessionProvider((e=>e&&n.has(e)?e.sessionContext:null))}},I={id:"@jupyterlab/console-extension:cursor-position",autoStart:!0,requires:[l.IConsoleTracker,a.IPositionModel],activate:(e,n,t)=>{let o=null;t.addEditorProvider((async e=>{let r=null;if(e!==o){if(null==o||o.console.promptCellCreated.disconnect(t.update),o=null,e&&n.has(e)){e.console.promptCellCreated.connect(t.update);const n=e.console.promptCell;r=null,n&&(await n.ready,r=n.editor),o=e}}else if(e){const n=e.console.promptCell;r=null,n&&(await n.ready,r=n.editor)}return r}))}},E=[_,x,f,S,I,{id:"@jupyterlab/console-extension:completer",autoStart:!0,requires:[l.IConsoleTracker],optional:[s.ICompletionProviderManager,m.ITranslator,r.ISanitizer],activate:function(e,n,t,o,a){if(!t)return;const s=(null!=o?o:m.nullTranslator).load("jupyterlab"),l=null!=a?a:new r.Sanitizer;e.commands.addCommand(w.invokeCompleter,{label:s.__("Display the completion helper."),execute:()=>{const e=n.currentWidget&&n.currentWidget.id;if(e)return t.invoke(e)}}),e.commands.addCommand(w.selectCompleter,{label:s.__("Select the completion suggestion."),execute:()=>{const e=n.currentWidget&&n.currentWidget.id;if(e)return t.select(e)}}),e.commands.addKeyBinding({command:w.selectCompleter,keys:["Enter"],selector:".jp-ConsolePanel .jp-mod-completer-active"});const i=async(e,n)=>{var o,r;const a={editor:null!==(r=null===(o=n.console.promptCell)||void 0===o?void 0:o.editor)&&void 0!==r?r:null,session:n.console.sessionContext.session,widget:n};await t.updateCompleter(a),n.console.promptCellCreated.connect(((e,o)=>{const r={editor:o.editor,session:e.sessionContext.session,widget:n,sanitzer:l};t.updateCompleter(r).catch(console.error)})),n.console.sessionContext.sessionChanged.connect((()=>{var e,o;const r={editor:null!==(o=null===(e=n.console.promptCell)||void 0===e?void 0:e.editor)&&void 0!==o?o:null,session:n.console.sessionContext.session,widget:n,sanitizer:l};t.updateCompleter(r).catch(console.error)}))};n.widgetAdded.connect(i),t.activeProvidersChanged.connect((()=>{n.forEach((e=>{i(0,e).catch((e=>console.error(e)))}))}))}}]}}]);